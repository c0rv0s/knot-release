
<!doctype>
<html>
    <head>
        <script type="text/javascript" src="./web3.js"></script>
        <script type="text/javascript">
            var web3 = new Web3();
            web3.setProvider(
                             // Geth instance address
                             new web3.providers.HttpProvider("http://54.84.157.95:8545")
                             );
                             
                             function contractmaker(){
                                 
                                 var itemregisterContract = web3.eth.contract([{"constant":false,"inputs":[{"name":"iid","type":"string"},{"name":"uid","type":"string"},{"name":"tstamp","type":"uint256"}],"name":"init","outputs":[],"type":"function"},{"constant":false,"inputs":[{"name":"tstamp","type":"uint256"}],"name":"renewtimestamp","outputs":[],"type":"function"},{"constant":true,"inputs":[],"name":"itemID","outputs":[{"name":"","type":"string"}],"type":"function"},{"constant":true,"inputs":[],"name":"gettimestamp","outputs":[{"name":"retVal","type":"uint256"}],"type":"function"},{"constant":true,"inputs":[],"name":"timestamp","outputs":[{"name":"","type":"uint256"}],"type":"function"},{"constant":true,"inputs":[],"name":"getitemid","outputs":[{"name":"retVal","type":"string"}],"type":"function"},{"constant":true,"inputs":[],"name":"userID","outputs":[{"name":"","type":"string"}],"type":"function"},{"constant":true,"inputs":[],"name":"getuserid","outputs":[{"name":"retVal","type":"string"}],"type":"function"}]);
                                 
                                 var itemregister = itemregisterContract.new(
                                                                             {
                                                                             from: web3.eth.accounts[0],
                                                                             data: '60606040526107c9806100126000396000f36060604052361561008a576000357c0100000000000000000000000000000000000000000000000000000000900480632eabc9171461008c5780633f1bd6f81461013257806343cdef601461014a5780637c15dd60146101c5578063b80777ea146101e8578063b84e06d01461020b578063e302418a14610286578063ea98c206146103015761008a565b005b6101306004808035906020019082018035906020019191908080601f016020809104026020016040519081016040528093929190818152602001838380828437820191505050505050909091908035906020019082018035906020019191908080601f01602080910402602001604051908101604052809392919081815260200183838082843782019150505050505090909190803590602001909190505061037c565b005b61014860048080359060200190919050506104e6565b005b61015760048050506104f4565b60405180806020018281038252838181518152602001915080519060200190808383829060006004602084601f0104600f02600301f150905090810190601f1680156101b75780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b6101d26004805050610595565b6040518082815260200191505060405180910390f35b6101f560048050506105a7565b6040518082815260200191505060405180910390f35b61021860048050506105b0565b60405180806020018281038252838181518152602001915080519060200190808383829060006004602084601f0104600f02600301f150905090810190601f1680156102785780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b610293600480505061066c565b60405180806020018281038252838181518152602001915080519060200190808383829060006004602084601f0104600f02600301f150905090810190601f1680156102f35780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b61030e600480505061070d565b60405180806020018281038252838181518152602001915080519060200190808383829060006004602084601f0104600f02600301f150905090810190601f16801561036e5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b8260006000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106103cb57805160ff19168380011785556103fc565b828001600101855582156103fc579182015b828111156103fb5782518260005055916020019190600101906103dd565b5b5090506104279190610409565b808211156104235760008181506000905550600101610409565b5090565b50508160016000509080519060200190828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061047857805160ff19168380011785556104a9565b828001600101855582156104a9579182015b828111156104a857825182600050559160200191906001019061048a565b5b5090506104d491906104b6565b808211156104d057600081815060009055506001016104b6565b5090565b5050806002600050819055505b505050565b806002600050819055505b50565b60006000508054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561058d5780601f106105625761010080835404028352916020019161058d565b820191906000526020600020905b81548152906001019060200180831161057057829003601f168201915b505050505081565b600060026000505490506105a4565b90565b60026000505481565b602060405190810160405280600081526020015060006000508054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561065d5780601f106106325761010080835404028352916020019161065d565b820191906000526020600020905b81548152906001019060200180831161064057829003601f168201915b50505050509050610669565b90565b60016000508054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156107055780601f106106da57610100808354040283529160200191610705565b820191906000526020600020905b8154815290600101906020018083116106e857829003601f168201915b505050505081565b602060405190810160405280600081526020015060016000508054600181600116156101000203166002900480601f0160208091040260200160405190810160405280929190818152602001828054600181600116156101000203166002900480156107ba5780601f1061078f576101008083540402835291602001916107ba565b820191906000526020600020905b81548152906001019060200180831161079d57829003601f168201915b505050505090506107c6565b9056',
                                                                             gas: 3000000
                                                                             },
                                                                             function(e, contract){
                                                                             console.log(e, contract);
                                                                             if (typeof contract.address != 'undefined') {
                                                                             console.log('Contract mined! address: ' + contract.address + ' transactionHash: ' + contract.transactionHash);
                                                                             
                                                                             }
                                                                             });
                                                                             //but this is not returned immidiately.
                                                                             return itemregister.transactionHash;
                                                                             
                             }
        
        
        var abi = [{"constant":false,"inputs":[{"name":"iid","type":"string"},{"name":"uid","type":"string"},{"name":"tstamp","type":"uint256"}],"name":"init","outputs":[],"type":"function"},{"constant":false,"inputs":[{"name":"tstamp","type":"uint256"}],"name":"renewtimestamp","outputs":[],"type":"function"},{"constant":true,"inputs":[],"name":"itemID","outputs":[{"name":"","type":"string"}],"type":"function"},{"constant":true,"inputs":[],"name":"gettimestamp","outputs":[{"name":"retVal","type":"uint256"}],"type":"function"},{"constant":true,"inputs":[],"name":"timestamp","outputs":[{"name":"","type":"uint256"}],"type":"function"},{"constant":true,"inputs":[],"name":"getitemid","outputs":[{"name":"retVal","type":"string"}],"type":"function"},{"constant":true,"inputs":[],"name":"userID","outputs":[{"name":"","type":"string"}],"type":"function"},{"constant":true,"inputs":[],"name":"getuserid","outputs":[{"name":"retVal","type":"string"}],"type":"function"}];
        
        var myCoinbaseAddress = "0xc8ca03fd80f08188520422431853b382e0df348e";
        
        function renewtimestamp(address, time){
            //var contractAddress = "0x196aa0f33b9911ebc21381fcfe5e41fa5e784f1c";
            var contract = web3.eth.contract(abi).at(address);
            return contract.renewtimestamp.sendTransaction(time, {from: myCoinbaseAddress, gas: 900000});
        }
        function contractinit(address, uid, iid, time){
            var contract = web3.eth.contract(abi).at(address);
            return contract.init.sendTransaction(uid, iid, time, {from: myCoinbaseAddress, gas: 900000});
            
        }
        
            </script>
    </head>
    <body>
    </body>
</html>